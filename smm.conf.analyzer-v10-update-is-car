input {                                                                                                      
        kafka {                                                                                              
                bootstrap_servers => "localhost:19092"                                                       
                topics_pattern => "(smm-.*)"                                                                 
                group_id => "v10"                                                                            
                auto_offset_reset => "earliest"                                                              
        }                                                                                                    
}                                                                                                            
                                                                                                             
filter {                                                                                                     
        mutate {                                                                                             
            rename  => [ "message", "msg" ]                                                                  
        }                                                                                                    
        json {                                                                                               
            source => ["msg"]                                                                                
            add_field => { "[@metadata][_index]" => "%{_index}" }                                            
            add_field => { "[@metadata][_type]" => "%{_type}" }                                              
            add_field => { "[@metadata][_id]" => "%{_id}" }                                                  
            add_field => { "[@metadata][action]" => "%{action}" }                                            
            remove_field => ["msg", "_index", "_type", "_id", "action","@version","@timestamp"]              
        }                                                                                                    
}                                                                                                            
                                                                                                             
output {                                                                                                     
#       stdout { codec => rubydebug }                                                                        
        elasticsearch {                                                                                      
                        hosts => "115.84.183.195:9200"                                                       
                        sniffing => true                                                                     
                        retry_on_conflict => 10                                                              
                        http_compression => true                                                             
                        index => "%{[@metadata][_index]}"                                                    
                        document_type => "%{[@metadata][_type]}"                                             
                        document_id => "%{[@metadata][_id]}"                                                 
                        action => "%{[@metadata][action]}"                                                   
        }                                                                                                    
                                                                                                             
                                                                                                             
}                                                                                                            